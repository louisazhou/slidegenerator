<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Paginated Slide Content</title>
<style>
/* Default theme for slide generation */
/* Extracted from layout_engine.py hardcoded CSS */

/* Slide dimensions and aspect ratio configuration */
:root {
    --slide-width: 960px;
    --slide-height: 540px;
    --slide-padding: 19px;       /* Configurable slide padding in pixels */
    --slide-font-family: 'Arial'; /* Font family that matches PowerPoint exactly */
    --column-gap: 15px;          /* Gap between columns */
    --column-padding: 5px;       /* Padding inside each column */
    
    /* Table styling deltas */
    --table-font-delta: -2pt;    /* Table font size = body - 2pt */
    --table-width-safety: 1.10;  /* 10% safety buffer for table width (1.10 = 110%) */
    /* NOTE: --table-border-width removed - python-pptx limitation
     * PowerPoint ignores border thickness in XML even when valid
     * Only border COLOR can be controlled via python-pptx
     * For custom thickness: use PPTX templates or VBA/Aspose.Slides */
}

body {
    margin: 0;
    padding: 0;
    font-family: var(--slide-font-family), sans-serif;
    color: #000000;
    background-color: #ffffff;
}

.slide {
    width: var(--slide-width);
    min-height: var(--slide-height); /* Allow content to extend beyond slide for debugging */
    padding: var(--slide-padding);
    box-sizing: border-box;
    position: relative;
    page-break-after: always;
    background-color: #ffffff;
    color: #000000;
    overflow: visible; /* Show all content in HTML for debugging */
    border: 2px dashed #ccc; /* Visual indicator of slide boundaries */
}

h1 {
    font-size: 16px;
    line-height: 1.2;
    margin-top: 0;
    margin-bottom: 20px;
    width: fit-content;
    color: #000000;
}

h2 {
    font-size: 13px;
    line-height: 1.2;
    margin-top: 0;
    margin-bottom: 15px;
    width: fit-content;
    color: #000000;
}

h3 {
    font-size: 11px;
    line-height: 1.2;
    margin-top: 0;
    margin-bottom: 12px;
    width: fit-content;
    color: #000000;
}

p {
    font-size: 10px;
    line-height: 1.2;
    margin-bottom: 0px;
    width: fit-content;
    max-width: 100%;
    color: #000000;
}

ul, ol {
    font-size: 10px;
    line-height: 1.2;
    margin-left: 20px;
    margin-bottom: 0px;
    width: fit-content;
    max-width: calc(100% - 20px);
}

li {
    line-height: 1.2;
    margin-bottom: 8px;
    width: fit-content;
    max-width: 100%;
}

/* Code blocks - separate styling for pre and inline code */
pre {
    font-family: 'Courier New', monospace;
    font-size: 14px;
    line-height: 1.2;
    background-color: #f4f4f4;
    color: #333333;
    padding: 10px;
    border-radius: 4px;
    margin-bottom: 15px;
    width: auto;
    max-width: 100%; /* Ensure code blocks fit within slide boundaries */
    overflow-x: auto; /* Add horizontal scrolling if needed */
    white-space: pre-wrap; /* Allow text wrapping in code blocks */
    word-wrap: break-word; /* Break long words if necessary */
    box-sizing: border-box; /* Include padding in width calculation */
    display: block; /* Ensure block display */
}

pre code {
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
    background-color: transparent; /* Don't double-apply background */
    color: inherit;
    padding: 0; /* Don't double-apply padding */
    border-radius: 0;
    margin: 0;
    white-space: inherit;
    word-wrap: inherit;
    box-sizing: border-box;
}

code {
    font-family: 'Courier New', monospace;
    font-size: 10px;
    background-color: #f4f4f4;
    color: #333333;
    padding: 2px 4px;
    border-radius: 2px;
}

table {
    border-collapse: collapse;
    width: fit-content;
    max-width: 100%; /* Prevent overflow but allow natural width */
    margin-bottom: 15px;
    table-layout: auto; /* Allow intelligent column sizing */
    word-wrap: break-word; /* Break long words if necessary */
}

th, td {
    border: 1px solid #000;
    padding: 8px;
    text-align: left;
    background-color: transparent;
    color: #000;
    line-height: 1.4;
    font-size: 10px; /* Match paragraph size so browser measurement matches PPT */
    word-wrap: break-word; /* Break long words in table cells */
    max-width: 200px; /* Prevent individual cells from getting too wide */
    overflow-wrap: break-word; /* Modern CSS property for word breaking */
}

th {
    font-weight: bold;
}

.page-break {
    display: none;  /* Hidden in CSS but will be detected by JavaScript */
}

/* Two-column layout support */
.columns {
  display: flex;
  gap: var(--column-gap);
  align-items: flex-start; /* Keep columns aligned to top */
  break-inside: avoid; /* Prevent page breaks inside column container */
  page-break-inside: avoid;
}

.column {
  flex: 1 1 0;
  padding: 0 var(--column-padding);
  min-width: 0; /* Prevent columns from overflowing */
  break-inside: avoid;
  page-break-inside: avoid;
}

/* Ensure tables inside columns fill the available column width */
.column table {
  width: max-content; /* natural width */
  max-width: 100%;
}

/* Column width flex rules */
.column[data-column-width="auto"] { flex: 0 0 auto; }
.column[data-column-width="default"] { flex: 1 1 0; }

/* Highlighted inline text */
mark {
    color: #ff8c00; /* Orange highlight color */
    background-color: transparent;
}

/* Inline color utility classes generated to match COLOR_MAP in renderer */
.red { color: rgb(255,0,0); }
.blue { color: rgb(0,102,204); }
.green { color: rgb(0,153,0); }
.orange { color: rgb(255,128,0); }
.purple { color: rgb(153,0,153); }
.gray { color: rgb(128,128,128); }
.black { color: rgb(0,0,0); }
.white { color: rgb(255,255,255); }
.yellow { color: rgb(255,255,0); }
.dodgerblue { color: rgb(30,144,255); } 

/* Inline formatting utility classes for attribute syntax */
.bold { font-weight: bold; }
.italic { font-style: italic; }
.underline { text-decoration: underline; }
.strike { text-decoration: line-through; }

/* Wavy underline utility */
.wavy { text-decoration: underline; text-decoration-style: wavy; text-decoration-color: inherit; }

/* Figure caption styling */
.figure-caption {
    font-style: italic;
    color: #666666;
    font-size: 10px;
    margin-top: 5px;
    text-align: center;
}

/* Divider slide styling - centered content with larger fonts */
.slide.divider {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    min-height: calc(var(--slide-height) - 2 * var(--slide-padding));
}

.slide.divider h1 {
    font-size: calc(var(--h1-font-size) + 2px);
    margin-bottom: 0.5em;
}

.slide.divider h2 {
    font-size: calc(var(--h2-font-size) + 2px);
    margin-bottom: 0.3em;
}

.slide.divider h3 {
    font-size: calc(var(--h3-font-size) + 2px);
    margin-bottom: 0.3em;
}

/* Admonition blocks */
.admonition { padding: 8px 12px; margin: 10px 0; border-left: 4px solid #2196F3; background-color: #E8F0FF; }
.admonition-title { font-weight: bold; margin-top: 0; margin-bottom: 4px; font-size: 10px; }
.admonition.note { border-color:#2196F3; background:#E8F0FF; }
.admonition.summary { border-color:#2196F3; background:#E8F0FF; }
.admonition.info { border-color:#039BE5; background:#E0F7FA; }
.admonition.tip { border-color:#388E3C; background:#E8F5E9; }
.admonition.warning { border-color:#FB8C00; background:#FFF9C4; }
.admonition.caution { border-color:#FB8C00; background:#FFF9C4; }
.admonition.danger { border-color:#E53935; background:#FFEBEE; }
.admonition.error { border-color:#D32F2F; background:#FFEBEE; }
.admonition.failure { border-color:#D32F2F; background:#FFEBEE; }
.admonition.attention { border-color:#FFA000; background:#FFF9DB; } 

/* ------------------------------------------------------------------
   Minimal icon support so browser & PPTX measure same height.
   Keep emoji inline to avoid external assets; must sync with ICONS in
   pptx_renderer.py.  Only prepend icon to title; spacing via trailing space. 
-------------------------------------------------------------------*/
.admonition-title::before { margin-right:4px; }
.admonition.note > .admonition-title::before,
.admonition.summary > .admonition-title::before { content:"ðŸ“"; }
.admonition.info > .admonition-title::before { content:"â„¹ï¸"; }
.admonition.tip > .admonition-title::before { content:"ðŸ’¡"; }
.admonition.warning > .admonition-title::before,
.admonition.caution > .admonition-title::before { content:"âš ï¸"; }
.admonition.danger > .admonition-title::before { content:"ðŸš«"; }
.admonition.error > .admonition-title::before,
.admonition.failure > .admonition-title::before { content:"âŒ"; }
.admonition.attention > .admonition-title::before { content:"ðŸ‘€"; }

/* Math text styling - shows raw LaTeX */
.math-text {
    font-family: 'Courier New', monospace;
    color: #d63384;
    font-weight: 500;
}

.math-image {
    max-width: 100%;
    height: auto;
}

.math-image.inline {
    display: inline;
    vertical-align: baseline;
}

.math-image.display {
    display: block;
    margin: 0.5em auto;
} 
/* list bullet helper for debug view will be injected later */
.slide{margin-bottom:40px;border:3px solid red;position:relative;}
.slide:before{position:absolute;top:-26px;left:0;background:red;color:#fff;padding:4px 8px;font-weight:bold;content:attr(data-idx);}
</style>
</head>
<body>
<hr style="border:2px dashed #999;margin:40px 0;"/>
<div class="slide" data-idx="1" id="slide-1">
<h1 data-bid="b0">Test Slide</h1>
<p data-bid="b1">Here is inline math: <span class="math inline" data-bid="b2">E=mc^2</span> and some display math:</p>
<div class="math block" data-bid="b3">
\int_0^1 x^2 dx = rac{1}{3}
</div>
<p data-bid="b4">End of test.</p>
</div>
<style>.dbg-list{display:block;text-indent:-1em;padding-left:1em;margin-left:20px;margin-top:0;margin-bottom:0;line-height:inherit;}</style>
</body>
</html>